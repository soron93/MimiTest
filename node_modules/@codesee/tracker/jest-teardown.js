/**
 * This file is used to inject an afterAll teardown
 * helper function. The CodeSee babel plugin will
 * inject a require statement for this file at the
 * top of test files it instruments:
 *
 * require ("@codesee/tracker/jest-teardown.js");
 *
 * Jest runs afterAll teardown hooks in the reverse
 * of the order that the afterAll statements appear,
 * that is, LIFO. By requiring this file at the top
 * of each test file, we ensure the afterAll statement
 * in this is the last one to run.
 */

// eslint-disable-next-line jest/no-done-callback
afterAll((done) => {
  if (global.CodeSee) {
    CodeSee.waitForEventsToDrain((url) => {
      CodeSee._impl.log(`Recording saved: ${url}`);
      done();
    });
  } else {
    done();
  }
});
